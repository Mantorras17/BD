1. Qual é o número de óbitos por género?
    Mostra o género e o número de óbitos.

SELECT GRUPOS.genero, SUM(ESTATISTICAS.obitos) as obitos
FROM ESTATISTICAS
NATURAL JOIN GRUPOS
GROUP BY GRUPOS.genero
ORDER BY obitos DESC


2. Qual é o número de óbitos por faixa etaria?
    Mostra a idade minima, idade máxima, e o número de óbitos. Ordena por idade mínima.

SELECT FAIXAS_ETARIAS.idade_min, FAIXAS_ETARIAS.idade_max, SUM(ESTATISTICAS.obitos) as obitos
FROM ESTATISTICAS
NATURAL JOIN GRUPOS
NATURAL JOIN FAIXAS_ETARIAS
GROUP BY FAIXAS_ETARIAS.idade_min
ORDER BY obitos DESC


3. Qual é o número de óbitos registados por região?
    Mostra o nome da região e o número de óbitos, ordenado pelo numero de óbitos descendente.

SELECT REGIOES.nome, SUM(ESTATISTICAS.obitos) as obitos
FROM ESTATISTICAS
NATURAL JOIN HOSPITAIS
NATURAL JOIN REGIOES
GROUP BY REGIOES.regiao_id
ORDER BY obitos DESC


4. Quais são as doenças mais mortiferas por região?
    Mostra o nome da região, a descrição da doença e os óbitos. Ordena pelos óbitos descendentes.

5. Qual é o número total de internamentos por hospital?
    Mostra o nome do hospital e o número de internamentos, ordenado pelo numero de internamentos descendente.

SELECT HOSPITAIS.hospital_id, HOSPITAIS.nome, SUM(ESTATISTICAS.internamentos) AS internamentos
FROM ESTATISTICAS
NATURAL JOIN HOSPITAIS
GROUP BY HOSPITAIS.hospital_id
ORDER BY internamentos DESC


6. Quais as regiões com o número de óbitos maior que 10000?
    Mostra o nome da região, o número de óbidos e o número de óbitos. Ordenados pelo número de óbidos decrescente.

SELECT REGIOES.nome, SUM(ESTATISTICAS.obitos) as obitos
FROM ESTATISTICAS
NATURAL JOIN HOSPITAIS
NATURAL JOIN REGIOES
GROUP BY REGIOES.REGIOES_regiao_id
HAVING SUM(ESTATISTICAS.obitos)>10000
ORDER BY obitos DESC


7. Qual é o número de óbitos por doença?
    Mostra o id da doença, a descrição da doença e o número de óbitos, ordenado pelo id da doença.

SELECT DOENCAS.doenca_id, DOENCAS.descricao, SUM(ESTATISTICAS.obitos) as obitos
FROM ESTATISTICAS
NATURAL JOIN DOENCAS
GROUP BY DOENCAS.doenca_id
ORDER BY obitos DESC


8. Qual a média de óbitos por doença?
    Mostra o id da doença, a descrição da doença e, dos registados (óbitos+internamentos+ambulatório), quantos foram óbitos. Ordena pela média descendente.

SELECT DOENCAS.doenca_id, DOENCAS.descricao, AVG(ESTATISTICAS.obitos*1.0/(ESTATISTICAS.obitos+ESTATISTICAS.ambulatorio+ESTATISTICAS.internamentos)) AS media
FROM ESTATISTICAS
NATURAL JOIN DOENCAS
WHERE (ESTATISTICAS.obitos+ESTATISTICAS.ambulatorio+ESTATISTICAS.internamentos)>0
GROUP BY DOENCAS.doenca_id
ORDER BY media DESC


9. Qual a média de óbitos por hospital?
    Mostra o código do hospital, o nome do hospital e, dos registados (óbitos+internamentos+ambulatório), quantos foram óbitos. Ordena pela média descendente.

SELECT HOSPITAIS.hospital_id, HOSPITAIS.nome, AVG(ESTATISTICAS.obitos*1.0/(ESTATISTICAS.obitos+ESTATISTICAS.ambulatorio+ESTATISTICAS.internamentos)) AS media
FROM ESTATISTICAS
NATURAL JOIN HOSPITAIS
WHERE (ESTATISTICAS.obitos+ESTATISTICAS.ambulatorio+ESTATISTICAS.internamentos)>0
GROUP BY HOSPITAIS.hospital_id
ORDER BY media DESC


10. Qual a média de dias de internamento, para cada doença?
    Mostra o id da doença, a descrição da doença, e a média de dias de internamento. Ordena por média descendente.

SELECT DOENCAS.doenca_id, DOENCAS.descricao, SUM(ESTATISTICAS.dias_de_internamento)/SUM(ESTATISTICAS.internamentos) AS media
FROM ESTATISTICAS
NATURAL JOIN DOENCAS
GROUP BY DOENCAS.doenca_id
ORDER BY media DESC


11. Qual o número de óbitos de crianças, adolescentes, adultos e idosos?
    Mostra o número de óbitos por crianças(0<=idade_min<15), jovens(idade_min>=15,idade_max<=25), adultos(idade_min>=25, idade_max<=65) e idosos(idade_min<=65).

SELECT 
    CASE 
        WHEN FAIXAS_ETARIAS.idade_min >= 0 AND FAIXAS_ETARIAS.idade_max <= 15 THEN 'Crianças'
        WHEN FAIXAS_ETARIAS.idade_min >= 15 AND FAIXAS_ETARIAS.idade_max <= 25 THEN 'Jovens'
        WHEN FAIXAS_ETARIAS.idade_min >= 25 AND FAIXAS_ETARIAS.idade_max <= 65 THEN 'Adultos'
        WHEN FAIXAS_ETARIAS.idade_min >= 65 THEN 'Idosos'
    END AS FAIXAS_ETARIAS, SUM(ESTATISTICAS.obitos) AS obitos
FROM ESTATISTICAS
NATURAL JOIN GRUPOS
NATURAL JOIN FAIXAS_ETARIAS
GROUP BY FAIXAS_ETARIAS
ORDER BY obitos DESC;

12. Como variou o número de óbidos ao longo do tempo?
    Mostra o periodo e o número de óbidos. Ordena pelo crescente.

SELECT ESTATISTICAS.periodo, SUM(ESTATISTICAS.obitos) AS obidos
FROM ESTATISTICAS
GROUP BY ESTATISTICAS.periodo
ORDER BY periodo


13. Qual a média de óbitos por ano?

SELECT SUBSTRING(ESTATISTICAS.periodo,1,4) AS ano, SUM(ESTATISTICAS.obitos) AS obitos
FROM ESTATISTICAS
GROUP BY ano
ORDER BY obitos DESC;